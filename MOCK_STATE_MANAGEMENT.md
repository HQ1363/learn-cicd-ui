# Mock ç³»ç»ŸçŠ¶æ€ç®¡ç†æ›´æ–°

## ğŸ”¥ é‡å¤§æ›´æ–°ï¼šæ”¯æŒåŠ¨æ€çŠ¶æ€ç®¡ç†

### é—®é¢˜

ä¹‹å‰çš„ Mock ç³»ç»Ÿæ˜¯**é™æ€**çš„ï¼Œåˆ›å»ºä»»åŠ¡åæ²¡æœ‰çœŸæ­£ä¿å­˜ï¼ŒæŸ¥è¯¢æ—¶è¿˜æ˜¯è¿”å›å›ºå®šçš„æ•°æ®ï¼Œå¯¼è‡´ï¼š
- âŒ æ·»åŠ ä»»åŠ¡åï¼Œåˆ·æ–°æŸ¥è¯¢çœ‹ä¸åˆ°æ–°ä»»åŠ¡
- âŒ åˆ é™¤ä»»åŠ¡åï¼Œä»»åŠ¡è¿˜åœ¨åˆ—è¡¨ä¸­
- âŒ æ›´æ–°ä»»åŠ¡åï¼Œæ•°æ®æ²¡æœ‰å˜åŒ–

### è§£å†³æ–¹æ¡ˆ

ç°åœ¨çš„ Mock ç³»ç»Ÿæ”¯æŒ**åŠ¨æ€å†…å­˜çŠ¶æ€ç®¡ç†**ï¼Œæ‰€æœ‰æ“ä½œéƒ½ä¼šå®æ—¶åæ˜ åœ¨å†…å­˜ä¸­ï¼š
- âœ… æ·»åŠ ä»»åŠ¡ â†’ çœŸæ­£ä¿å­˜åˆ°å†…å­˜ â†’ ä¸‹æ¬¡æŸ¥è¯¢èƒ½çœ‹åˆ°
- âœ… åˆ é™¤ä»»åŠ¡ â†’ çœŸæ­£ä»å†…å­˜åˆ é™¤ â†’ ä¸‹æ¬¡æŸ¥è¯¢çœ‹ä¸åˆ°
- âœ… æ›´æ–°ä»»åŠ¡ â†’ çœŸæ­£ä¿®æ”¹å†…å­˜æ•°æ® â†’ ä¸‹æ¬¡æŸ¥è¯¢çœ‹åˆ°æœ€æ–°å€¼

## ğŸ—ï¸ æŠ€æœ¯å®ç°

### 1. å†…å­˜å­˜å‚¨ç»“æ„

```javascript
// æ¯ä¸ªæµæ°´çº¿ç»´æŠ¤ç‹¬ç«‹çš„é˜¶æ®µå’Œä»»åŠ¡æ•°æ®
let pipelineDesignData = {
    'pipeline-001': {
        stages: [...]  // é˜¶æ®µæ•°ç»„ï¼ŒåŒ…å«åµŒå¥—çš„ä»»åŠ¡
    },
    'pipeline-002': {
        stages: [...]
    }
}
```

### 2. æ ¸å¿ƒè¾…åŠ©å‡½æ•°

#### `ensurePipelineData(pipelineId)`
ç¡®ä¿æµæ°´çº¿æœ‰åˆå§‹åŒ–çš„æ•°æ®ç»“æ„ï¼Œé¦–æ¬¡è®¿é—®æ—¶è‡ªåŠ¨åˆ›å»ºé»˜è®¤çš„3ä¸ªé˜¶æ®µï¼š
- æºç ï¼ˆåŒ…å«Gitä»»åŠ¡ï¼‰
- æ„å»ºï¼ˆåŒ…å«Mavenä»»åŠ¡ï¼‰
- éƒ¨ç½²ï¼ˆåŒ…å«ä¸»æœºéƒ¨ç½²ä»»åŠ¡ï¼‰

#### `addTaskToStage(stages, stageId, newTask)`
åœ¨æŒ‡å®šé˜¶æ®µä¸­æ·»åŠ ä»»åŠ¡

#### `updateTaskInStage(stages, taskId, updatedData)`
æ›´æ–°æŒ‡å®šä»»åŠ¡çš„æ•°æ®

#### `deleteTaskFromStage(stages, taskId)`
ä»é˜¶æ®µä¸­åˆ é™¤æŒ‡å®šä»»åŠ¡

### 3. æ›´æ–°çš„ API

#### æŸ¥è¯¢é˜¶æ®µ `/stage/finAllStage`
```javascript
// âœ… ä»åŠ¨æ€å­˜å‚¨è¯»å–
const pipelineData = ensurePipelineData(pipelineId);
return successResponse(pipelineData.stages);
```

#### åˆ›å»ºä»»åŠ¡ `/tasks/createTask`
```javascript
// 1. ç”Ÿæˆå”¯ä¸€ID
const newTaskId = `task-${Date.now()}-${taskIdCounter++}`;

// 2. åˆ›å»ºä»»åŠ¡å¯¹è±¡
const newTask = { taskId, taskType, taskName, ... };

// 3. âœ… æ·»åŠ åˆ°åŠ¨æ€å­˜å‚¨
const pipelineData = ensurePipelineData(pipelineId);
addTaskToStage(pipelineData.stages, stageId, newTask);
```

#### æ›´æ–°ä»»åŠ¡ `/tasks/updateTask`
```javascript
// âœ… åœ¨åŠ¨æ€å­˜å‚¨ä¸­æ›´æ–°
const pipelineData = ensurePipelineData(pipelineId);
updateTaskInStage(pipelineData.stages, taskId, data);
```

#### åˆ é™¤ä»»åŠ¡ `/tasks/deleteTask`
```javascript
// âœ… ä»åŠ¨æ€å­˜å‚¨ä¸­åˆ é™¤
const pipelineData = ensurePipelineData(pipelineId);
deleteTaskFromStage(pipelineData.stages, taskId);
```

#### é˜¶æ®µæ“ä½œ
- `/stage/createStage` - åˆ›å»ºæ–°é˜¶æ®µå¹¶æ·»åŠ åˆ°æ•°ç»„
- `/stage/updateStage` - æ›´æ–°é˜¶æ®µæ•°æ®
- `/stage/deleteStage` - ä»æ•°ç»„ä¸­åˆ é™¤é˜¶æ®µ

## ğŸ¯ ä½¿ç”¨æ•ˆæœ

### åœºæ™¯1ï¼šæ·»åŠ ä»»åŠ¡

```javascript
// 1. ç”¨æˆ·ç‚¹å‡»"æ·»åŠ ä»»åŠ¡"æŒ‰é’®
POST /tasks/createTask
{
    pipelineId: 'pipeline-001',
    stageId: 'stage-init-001-1',
    taskType: 'maven',
    taskName: 'Mavenæ„å»º'
}

// 2. Mock è¿”å›æ–°ä»»åŠ¡
â†’ ä»»åŠ¡ä¿å­˜åˆ° pipelineDesignData['pipeline-001'].stages[0].stageList[0].taskValues

// 3. ç”¨æˆ·åˆ·æ–°é¡µé¢
GET /stage/finAllStage?pipelineId=pipeline-001

// 4. Mock è¿”å›åŒ…å«æ–°ä»»åŠ¡çš„é˜¶æ®µåˆ—è¡¨
â†’ âœ… æ–°ä»»åŠ¡å‡ºç°åœ¨ç•Œé¢ä¸Šï¼
```

### åœºæ™¯2ï¼šåˆ é™¤ä»»åŠ¡

```javascript
// 1. ç”¨æˆ·ç‚¹å‡»"åˆ é™¤ä»»åŠ¡"æŒ‰é’®
DELETE /tasks/deleteTask
{
    taskId: 'task-init-001',
    pipelineId: 'pipeline-001'
}

// 2. Mock ä»å†…å­˜ä¸­åˆ é™¤
â†’ ä»»åŠ¡ä» pipelineDesignData['pipeline-001'].stages ä¸­ç§»é™¤

// 3. ç”¨æˆ·åˆ·æ–°é¡µé¢
GET /stage/finAllStage?pipelineId=pipeline-001

// 4. Mock è¿”å›ä¸åŒ…å«è¯¥ä»»åŠ¡çš„é˜¶æ®µåˆ—è¡¨
â†’ âœ… ä»»åŠ¡å·²ä»ç•Œé¢æ¶ˆå¤±ï¼
```

## ğŸ“Š æ•°æ®æµç¨‹

```
ç”¨æˆ·æ“ä½œ
   â†“
å‰ç«¯å‘é€è¯·æ±‚ (POST /tasks/createTask)
   â†“
Mock æ‹¦æˆªå™¨
   â†“
MockData.js å¤„ç†
   â†“
âœ… ä¿®æ”¹å†…å­˜ä¸­çš„ pipelineDesignData
   â†“
è¿”å›æˆåŠŸå“åº”
   â†“
å‰ç«¯åˆ·æ–°æŸ¥è¯¢ (GET /stage/finAllStage)
   â†“
Mock è¿”å›æœ€æ–°çš„å†…å­˜æ•°æ®
   â†“
âœ… ç•Œé¢æ˜¾ç¤ºæœ€æ–°æ•°æ®ï¼
```

## ğŸ” è°ƒè¯•

æ§åˆ¶å°ä¼šæ˜¾ç¤ºè¯¦ç»†çš„æ“ä½œæ—¥å¿—ï¼š

```
[Mock] ğŸ†• åˆ›å»ºä»»åŠ¡: {taskType: 'maven', taskName: 'Mavenæ„å»º', ...}
[Mock] âœ… ä»»åŠ¡åˆ›å»ºæˆåŠŸ: task-1730880000000-1001 Mavenæ„å»º

[Mock] ğŸ” æŸ¥è¯¢æµæ°´çº¿é˜¶æ®µ: pipeline-001
[Mock] âœ… è¿”å›é˜¶æ®µåˆ—è¡¨ï¼Œå…± 3 ä¸ªé˜¶æ®µ

[Mock] ğŸ—‘ï¸ åˆ é™¤ä»»åŠ¡: task-init-001 pipelineId: pipeline-001
[Mock] âœ… ä»»åŠ¡åˆ é™¤æˆåŠŸ: task-init-001
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ•°æ®ä»…å­˜åœ¨äºå†…å­˜ä¸­
- åˆ·æ–°æµè§ˆå™¨ = æ•°æ®é‡ç½®
- å…³é—­é¡µé¢ = æ•°æ®ä¸¢å¤±
- æ¯æ¬¡è®¿é—®æµæ°´çº¿éƒ½ä¼šé‡æ–°åˆå§‹åŒ–é»˜è®¤é˜¶æ®µ

### 2. ä¸åŒæµæ°´çº¿æ•°æ®ç‹¬ç«‹
- `pipeline-001` çš„æ•°æ®ä¸ä¼šå½±å“ `pipeline-002`
- æ¯ä¸ªæµæ°´çº¿ç»´æŠ¤è‡ªå·±çš„é˜¶æ®µå’Œä»»åŠ¡åˆ—è¡¨

### 3. é»˜è®¤åˆå§‹é˜¶æ®µ
é¦–æ¬¡è®¿é—®æµæ°´çº¿æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»º3ä¸ªç¤ºä¾‹é˜¶æ®µï¼š
- **æºç ** (å« Git ä»»åŠ¡)
- **æ„å»º** (å« Maven ä»»åŠ¡)
- **éƒ¨ç½²** (å«ä¸»æœºéƒ¨ç½²ä»»åŠ¡)

è¿™äº›å¯ä»¥è‡ªç”±åˆ é™¤æˆ–ä¿®æ”¹ã€‚

## âœ¨ ä¼˜åŠ¿

1. **çœŸå®æ¨¡æ‹Ÿ** - è¡Œä¸ºä¸çœŸå®åç«¯APIå®Œå…¨ä¸€è‡´
2. **å³æ—¶åé¦ˆ** - æ‰€æœ‰æ“ä½œç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€ç­‰å¾…
3. **ç‹¬ç«‹å¼€å‘** - å®Œå…¨ä¸ä¾èµ–åç«¯ï¼Œå¯ä»¥è‡ªç”±æµ‹è¯•å„ç§åœºæ™¯
4. **æ•°æ®éš”ç¦»** - æ¯ä¸ªæµæ°´çº¿æ•°æ®ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°
5. **æ˜“äºè°ƒè¯•** - æ§åˆ¶å°æ—¥å¿—æ¸…æ™°æ˜¾ç¤ºæ‰€æœ‰æ“ä½œ

## ğŸš€ ç°åœ¨å¯ä»¥

- âœ… è‡ªç”±æ·»åŠ ä»»åŠ¡ï¼Œå¹¶ç«‹å³åœ¨ç•Œé¢çœ‹åˆ°
- âœ… ç¼–è¾‘ä»»åŠ¡ï¼Œä¿®æ”¹ç«‹å³ç”Ÿæ•ˆ
- âœ… åˆ é™¤ä»»åŠ¡ï¼Œç•Œé¢ç«‹å³æ›´æ–°
- âœ… æ·»åŠ æ–°é˜¶æ®µï¼Œæ„å»ºå¤æ‚çš„æµæ°´çº¿
- âœ… æµ‹è¯•å„ç§æµæ°´çº¿ç¼–æ’åœºæ™¯
- âœ… å®Œå…¨ç¦»çº¿å¼€å‘ï¼Œä¸ä¾èµ–ä»»ä½•åç«¯æœåŠ¡

---

ğŸ‰ **ç°åœ¨ä½ å¯ä»¥è‡ªç”±ç¼–æ’æµæ°´çº¿äº†ï¼æ‰€æœ‰æ“ä½œéƒ½ä¼šçœŸå®ä¿å­˜å’Œåæ˜ åœ¨ç•Œé¢ä¸Šï¼**

